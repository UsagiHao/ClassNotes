# 软件需求工程

## 1 软件需求导论
### 1.1 软件生产中的需求问题
需求问题是当前软件开发面临的主要问题。  
软件的三种类别：  
* 面向专业用户的纯工具型软件
* 面向普通用户的纯工具型软件
* 应用型软件  

它们具有不同的关注点和评判标准，分别对应创新性、有效性和模拟性。不同的评判标准和关注点决定了3类软件在生产中也会有所不同，尤其是在分析阶段具有截然不同的目标。  
</br>
应用软件正确工作的基础是具有“模拟”性，具体是指：
* 目的性：软件的目标是直接或间接地满足用户的某些目的或者解决用户的某些问题
* 正确性
* 现实可理解性：软件实现其功能的基础、手段和过程是在用户领域内现实可理解的。
现实中常常对此类软件的“模拟”特性与应用问题缺乏重视  

需求问题的具体技术原因分析：    
* 理解需求处理中的非技术性和社会性因素：组织机构文化、社会背景、商业目标、利益协商
* 结构化分析和面向对象分析具有一定的先天缺陷
* 以企业为中心的软件反映出软件规模的扩大
* 纠正需求的错误需要极高的代价  

### 1.2 需求工程
#### 1.2.1 需求工程简介
**需求工程定义：**是软件工程的一个分支，它关注于软件系统所应予实现的现实世界目标、软件系统的功能和软件系统应当遵守的约束，同时它也关注以上因素和准确的软件行为规格说明之间的联系，关注以上因素与其随时间或跨产品族而演化之后的相关因素之间的联系。  
需求工程的基本活动：  
* 需求开发
  * 需求获取
  * 需求分析
  * 需求规格说明
  * 需求验证
* 需求管理  

#### 1.2.2 需求工程与系统工程
系统需求开发-早期阶段；软件需求开发-后期阶段。  

#### 1.2.3 需求工程的重要性
特定问题的具体特性掩盖了需求工程的重要性：问题广为人知；问题小而简单。

#### 1.2.4 需求工程的复杂性
处理范围广泛；涉及诸多参与方；处理内容多样；处理活动互相交织；处理结果要求苛刻。  

### 1.3 需求工程师
需求工程师是涉众与开发者之间的桥梁。  
需求工程师需要重视软技能（交流、观察、抽象分析和问题解决、写作、关系协调与团队工作）  


## 2 需求基础
### 2.1 需求的定义
1. 用户为了解决问题或达到某些目标所需要的条件或能力；
2. 系统或系统部件为了满足合同、标准、规范或其它正式文档所规定的要求而需要具备的条件或能力；
3. 对（1）或（2）中的一个条件或一种能力的一种文档化表述。  

### 2.2 满足需求就是解决问题
#### 2.2.1 问题与需求
现实的状况与人们期望的状况产生差距时，就产生了问题。  
开发软件系统的目的就是希望用它作为解决方案来解决问题，使现实改善到期望的状况。  

#### 2.2.2 问题解决的两个方面——问题域与解系统
**问题域：** 问题的发生地，也是问题解决的基本范围——解决问题必须涉及的事件和事物。问题域是需求的背景，问题域的背景信息（问题域自治的规律性）又称为问题域特性（包括结构特性和行为特性）。需要额外关注间接特性、约束与假设。  
**解系统：** 软件系统通过影响问题域帮助人们解决问题，称之为解系统。  
问题域与需求：**需求**是用户对问题域中的实体状态或事件的期望描述。需求开发最原始的出发点就是用户需求，或者需求的源头——问题。  
解系统与需求规格说明：**需求规格说明**是解系统为满足用户需求而提供的解决方案，规定了解系统的行为特征。  

#### 2.2.3 问题解决的基础——模拟与共享现象
问题域与解系统能够形成互动的基础是解系统部分模拟了问题域，称之为共享现象。  

#### 2.2.4 问题解决的方法——直接与间接
模拟并操纵共享现象是软件系统满足需求最直接的方法，但有些情况下软件系统也会使用间接的方法解决问题：软件系统操纵共享现象影响问题域的一部分，然后利用问题域内在的规律性自动影响另一部分

#### 2.2.5 问题解决方案——需求规格说明
主要包括：对共享现象（模型）的描述和对系统对共享对象所施加的操作的描述。  

#### 2.2.6 问题解决的困难性
1. 不存在描述明确的问题域特性E；
2. 不存在确定的针对定义良好的系统行为S的评估标准R（符合预期的需求）；
3. E=>S是一个创造性的过程。  

需求工程的主要工作：  
* 需求开发,确定R 
* 研究问题背景，描述问题域特性E 
* 构建解系统，描述解系统行为S，使得E,S|->R  

### 2.3 需求和问题都具有层次性
需求最常见的抽象层次：  
* 业务需求：针对整个业务的期望
* 用户需求：针对具体任务的期望
* 系统级需求：针对系统和用户一次交互的期望。  

#### 2.3.1 战略问题与业务需求
业务需求是抽象层次最高的需求，是系统建立的战略出发点，表现为高层次的目标，描述了组织为什么要开发系统。  
为了满足用户的业务需求，需求工程师需要描述系统高层次的解决方案（逐一细化），定义系统应该具备的特性。  

#### 2.3.2 任务问题与用户需求
用户需求就是执行实际工作的用户对系统所能完成的具体任务的期望，描述了系统能够帮助用户做些什么。  
**用户：** 直接用户和间接用户（通用、公共服务软件等用户无法确定的系统）  
基本表达方式：XX用户可以使用系统完成XX任务。  
用户需求的特点：  
* 模糊、不清晰：允许使用形容词和副词  
* 多特性混杂：允许混合功能和非功能性需求  
* 多逻辑混杂：一条用户需求所代表的任务需多次系统交互才能完成  

#### 2.3.3 系统行为问题与系统级需求
适合软件开发者的需求层次是系统级需求。用户对系统行为的期望，一系列的系统行为联系在一起可以帮助用户完成任务，满足业务需求。  
基本表达方式：系统可以XXX；在XXX用户提出XXX请求时，系统应该XXX。  


## 3 需求工程过程
### 3.1 概述
求工程过程是系统开发当中需求开发活动的集成。它的目标是产生一个能够在用户环境下解决用户业务问题的系统方案，并将其文档化为明确的规格说明。  
获取、分析、规格说明和验证并不是以线性顺序的执行，而是互相交织、迭代和递增的。

### 3.2 需求工程活动
#### 3.2.1 需求获取
需求获取是从人、资料或者环境当中获取需求的过程。需求获取和需求分析是交织在一起的。  
需求工程师需要执行的任务包括：
* 收集背景资料：深入了解以形成基础的知识框架。
* 获取问题与目标，定义项目的前景与范围：前景应对冲突、范围排除不必要的请求，坚定客户投资信心
* 识别涉众，选择信息的来源：来源：用户、硬数据、产品/专家/文档
* 选择获取方法，执行获取，获取功能与非功能需求：面谈、调查表、观察、原型等
* 记录获取结果：项目前景与范围文档、笔录记录

#### 3.2.2 需求分析
需求分析的主要工作是通过建模来整合各种信息，以使得人们更好的理解问题。同时为问题定义出一个需求集合，这个集合能够为问题界定一个有效的解决方案。还需要检查需求当中存在的错误、遗漏、不一致等各种缺陷，并加以修正。  
需求工程师的主要任务：
* 背景分析：研究系统将要部署的环境
* 问题分析、目标分析、业务分析、确定系统边界
* 需求建模
* 细化需求：用户需求转化为系统级需求
* 确定优先级
*　需求协商

#### 3.2.3 需求规格说明
编写文档的主要目的是为了在系统涉众之间交流需求信息：
* 业务需求——项目前景和范围文档
* 用户需求——用户需求文档（或者用例文档）
* 系统需求——需求规格说明
* 主要工作：定制文档模板——编写文档

#### 3.2.4 需求验证
确保文档满足标准：
* 文档内每条需求都正确、准确的反映了用户的意图
* 文档记录的需求集在整体上具有完整性和一致性
* 文档的组织方式和需求的书写方式具有可读性和可修改性
* 主要工作：执行验证（同级评审、原型、模拟）——问题修正（跟踪以确保落实）

#### 3.2.5 需求管理
主要工作：
* 建立和维护需求基线集 ：版本控制
* 建立需求跟踪信息（后向：制品，前向：高层需求）
* 进行变更控制：策略、团队

### 3.3 需求开发的过程是迭代和并发的
RT.

### 3.4 实践方法的应用
#### 3.4.1 细节知识的实践性
个人才智——实践方法——知识体系

#### 3.4.2 重要的实践方法
课本表3-1和3-2  
之后的章节会逐步介绍  

### 3.5 需求开发过程实例
* 螺旋模型：风险驱动项目的需求开发
* 原型模型：借鉴原型和分析模型的验证作用
* HP两阶段的需求开发过程模型
* 基于需求实践方法建立的需求开发模型
* 敏捷软件开发方法使用的需求开发模型
* RUP过程框架的需求开发模型

### 3.6 需求开发过程与软件工程过程的相互影响
需求工程过程是软件工程过程的一部分。  
相比于需求方法本身的好坏，需求方法与软件开发方法的适配性更会影响项目的成败。


## 4 需求获取概述  
### 4.1 需求获取的非平凡性  
* 用户和开发人员的背景不同，立场不同  
* 普通用户缺乏概括性、综合性的表述能力：开发人员在与用户接触之前就先行确定获取的内容主题，然后设计具体的应用环境和场景条件，由用户根据细节业务的执行来描述问题、表达期望。  
* 用户存在认知困境  
* 用户越庖代俎：用户提出的不是需求而是解决方案/固执的坚持某些特征和功能  
* 缺乏用户参与  

### 4.2 需求获取的活动过程  
#### 4.2.1 需求获取的子活动  
* 研究应用背景，建立初始的知识框架；  
* 根据获取的需要，采用必要的获取方法和技巧；  
* 先行确定获取的内容和主题，设定场景；  
* 分析用户的高（深）层目标，理解用户的意图；  
* 进行涉众分析，针对涉众的特点开展工作。  
#### 4.22 需求获取的活动过程  
图略  

### 4.3 需求获取活动的要点  
1. 获取的内容：在项目的范围之内；不是一次得到的，而是逐步积累的；  
2. 获取的来源：涉众、相关产品、硬数据  
3. 获取的方法：传统方法、原型等  
4. 获取的过程：维护项目的前景和范围；不要以抽象和模糊的需求作为结束；**结束获取活动的判断条件**（p83）  
5. 获取的结果：可以产生项目前景和范围文档、用例文档  

### 4.4 需求获取的实践情况调查  
略

### 小结  
* 需求获取的成功执行需要有效组织子活动过程
* 执行需求获取时既要尽可能全面，又要防止不完备，更要注意进行过程控制

；
## 5 确定项目的前景与范围
### 5.1 引言
定义项目前景、定义项目范围。  
确定项目前景和范围的活动是定义业务需求和能够满足需求的高层解决方案。如果存在不同业务需求之间的冲突，那么在确定项目前景和范围阶段必须予以解决。  
**确定项目的前景与范围，就是确定项目的问题、目标、特性**：  
* 问题：组织的战略目标、利益分配、政策规划、业务流程等高层问题
* 目标：问题的反面，用户的期望
* **特性：选定的、针对目标的解决方案所需要具备的功能特征，通常内聚于一个目标与任务，反映系统与外界一次有价值的完整互动过程**  
分析手段由浅到深依次为问题分析、目标分析、业务过程分析：  
* 问题与目标明确->问题分析->用例图/上下文图
* 目标之间存在较为复杂的关系->目标分析->目标模型与目标实现
* 目标、特性之间存在紧密的联系->业务过程分析->UML活动图  

### 5.2 问题分析
#### 5.2.1 获取问题
* 收集背景资料：收集业务描述、统计数据，关注业务困难与问题
* 与涉众沟通（面谈）  

#### 5.2.2 明确问题
* 达成共识的问题是一致的问题，但一致的问题不一定是明确的问题。问题的明确性要求它们具备以下两点：易于理解和能指明解决的方向  
* 分析不明确的问题，发现问题背后的问题：直接咨询涉众、利用收集的资料和业务数据、必要的问题分析技巧。  
* > 鱼骨图：显示某个总体效果的可能因子   

#### 5.2.3 发现业务需求
* 每一个明确、一致的问题都意味着涉众存在一些相应的期望目标，即业务需求。
* 一般情况下，业务需求就是问题的反面。  

#### 5.2.4 定义问题解决方案及系统特性
* 建立问题解决方案  
发现各种可行的高层次解决方案，分析不同方案的业务优势和代价，然后通过和涉众的协商进行选定。提供候选方案，最终由用户决定。  
* 确定系统特性和解决方案的边界  
  * 明确方案具备的功能特征（即**系统特性**）
  * 面向对象方法：用例图（角色：用户；用例：目标-任务）
  * 结构化方法：问题的上下文图（关注信息流输入输出）  
* 确定对解决方案的约束  

### 5.3 目标分析
问题分析将每一个问题都独立对待，这使得它易于操作但却只能适用于简单情况，因为复杂情况下的不同问题之间会存在相互依赖关系  
#### 5.3.1 “目标”概念——面向目标的软件需求工程方法
目标将会补充传统方法中的实体概念和行为概念，成为需求工程建模与分析的基本对象类别。  

#### 5.3.2 目标模型
**目标是系统被开发的目的**  
目标模型的描述需要精确描述和定义，常见基本特征：类型、名称、说明、优先级、可行性……  
* 目标的描述：类型、属性、链接
* 目标的层次：目标可以在不同的抽象层次上进行描述，可以针对不同的内容。高层次目标/低层次目标
* 目标的主体：抽象、粗粒度、范围广的目标拥有更多的主体，区分目标的主体与拥有者：拥有者通常是涉众，这些涉众期望目标达成但不一定参与目标达成过程  
* 目标的分类：功能目标/非功能目标，软目标/硬目标  

元素之间的关系——链接
* 精化：有助于目标完成-AND精化，直接保证目标完成-完备AND精化，替代方案-OR精化  
* 目标阻碍：子目标的达成会使得高层目标失败  
* 目标之间的支持和冲突
* 目标和其他需求模型元素建立链接:  
Assignment-目标和主体，Operationalization-目标和操作，Covers-目标和场景，Concerns-目标与应用领域对象  

#### 5.3.3 目标分析过程
* 高层目标的获取
* 目标精化  
  * 获取对高层目标的描述
  * 从高层目标描述获取AND精化关系
  * 从高层目标描述中获取“候选方法”，发现OR精化关系
  * 考虑阻碍目标实现的情况
  * 发现目标冲突关系
  * 完善层次结构
* 目标实现

### 5.4 非功能需求分析
#### 5.4.1 为什么需要非功能需求分析
面向产品/面向过程  

#### 5.4.2 非功能需求分析的困难
* 非功能需求不集中，在系统中散布
* 非功能需求不独立，依赖于功能需求
* 非功能需求的质量需求比较复杂
* 非功能需求相互冲突、依赖

#### 5.4.3 使用面向目标的方法分析非功能需求

### 5.5 业务过程分析
#### 5.5.1 活动图
* 节点：动作节点、控制节点、对象节点
* 流：控制流、对象流
* 令牌平衡：验证活动图流转是否正确
* 信号与事件机制：发送动作信号、接收事件动作
* 异常与中断机制：异常处理、可中断活动区
* 分区：活动组、活动分区、泳道
* 层次结构与图简化元素  

#### 5.5.2 使用活动图进行业务过程分析
* 确定活动图的上下文环境 
* 界定业务流程的处理界限 
* 分析业务流程中的主要处理步骤 
* 分析业务流程中的主要数据流 
* 识别参与者，进行职责分配，划分不同的泳道，将处理步骤和数据流的传递组织起来，建立活动图 
* 添加活动图的详细信息，完善活动图描述  

### 5.6 定义系统边界
* 问题分析与系统边界定义  
每个问题的解决方案边界的合并
* 目标分析与系统边界定义
  * 边界目标：存在系统与环境的互动。
  * 边界目标所覆盖的场景和操纵的操作
  * 关注的数据对象：建立系统边界定义。
* 业务过程分析与系统边界定义  
依据其动作和对象流完善边界定义  

### 5.7 前景和范围文档

## 6 涉众分析与硬数据采样
### 6.1 什么是涉众
所有对软件系统的开发和应用具有发言权和决定权的人称之为**涉众**。

### 6.2 涉众分析
#### 6.2.1 如何进行涉众分析
按照复杂程度将信息系统分类：  
* 小型系统
* 组织级系统
* 战略信息系统
* 组织间系统  

#### 6.2.2 涉众分析过程
* 涉众识别
* 涉众描述
* 涉众评估
* 涉众代表选择
* 制定涉众代表参与需求开发乃至软件系统的参与系统  

目标、范围、涉众的交织过程  

### 6.3 涉众识别
#### 6.3.1 发现所有的关键涉众类别
* 发现所有涉众类别：  
最简单的区分特征是任务，不同类别的涉众会执行不同的任务。复杂情况下可以分析涉众之间的互动，发现深层次的信息。  
* 过滤非关键涉众类别：  
分析一个涉众类别的任务或他们与外界的交互活动，如果属于项目范围，服务于系统目标的满足，就属于关键类型。
* 维护涉众类别：  
完成分类后继续保持适当的关注  

#### 6.3.2 识别涉众的方法
* 先膨胀后收缩方法
* 检查列表方法
* 涉众网络方法

### 6.4 涉众描述
#### 6.4.1 描述哪些内容
涉众因素：  
* 涉众的输赢条件
* 涉众的力量与意愿
* 涉众的个人特征与公众特征  

#### 6.4.2 描述示例
略

### 6.5 涉众评估
#### 6.5.1 优先级评估
优先考虑涉众的基本特征，尤其是任务特征。  
User/Task矩阵。  
Power/Interest分布图：参与者、环境设定者、被影响者、观众。  

#### 6.5.2 风险评估
Power/Attitude分布图：弱支持者、强支持者、弱反对者、强反对者。  
化解风险：  
* 提高环境参与者对系统的关注，将他们转变为参与者
* 消除强反对者的反对原因，将他们变为强支持者
* 给予被影响者充分发表和实现自身意见的权力
* 化解弱反对者的忧虑。  

#### 6.5.3 共赢分析
发现冲突：建立Stakeholder/Issue关系图  
* 列出所有涉众类别，描述兴趣和对系统的期望
* 由涉众的兴趣和期望发现背后涉及的共同问题
* 建立涉众类别与问题的关联
* 对每一个Stakeholder/Issue关系标明关系上被寄予的期望  

### 6.6 涉众代表选择
#### 6.6.1 涉众采样
完整采样、态度积极、数量适中、比例恰当

#### 6.6.2 用户替代源
和涉众接触频繁的人

### 6.7 涉众参与策略制定
#### 6.7.1 制定涉众参与的基本策略
建立涉众参与矩阵

#### 6.7.2 敏捷方法——用户参与
* 建立和用户的直接联系
* 用户参与软件系统开发的整个过程
* 反馈设计：最终的软件系统和用户的活动行为密切相关  

### 6.9 硬数据及硬数据采样
#### 6.9.1 硬数据
定量硬数据：数据收集表格、统计报表  
定性硬数据：整个组织的描述化文档、业务指导文档、业务备忘  

#### 6.9.2 硬数据采样
样本大小SS = 0.25*（确定性因子/可接受的错误）^2  


## 8 需求获取方法之面谈  
### 8.1 概述
面对面的会见被认为是最具丰富内容分交流方法  

### 8.2 准备面谈
#### 8.2.1 准备工作
准备的基础来自于项目的前景与范围定义。前景指出了面谈的方向，范围限定了面谈的主题；涉众分析结果可以帮助更好地选择被会见者和做好准备  
#### 8.2.2 问题类型  
问题基本上可以分为两种类型：  
* 开放式问题（Open-Ended）：被会见者对答复的选择可以是开放和不受限制的，他们可能答复两个词，也可能答复两段话。如“对公司中企业对企业电子商务的当前状态有何看法？”
* 封闭式问题（Closed）：答案有基本的形式，被会见者的回答是受到限制的。如 “项目存储库每个星期更新多少次？”；“电话中心一个月平均收到多少个电话？”
**程序性提示**：是针对一些人的思维特点而设计的面谈问题，包括：总结和反馈、重复和改述、建立场景和细节描述、抗辩等  
探究式问题  
诱导性问题（不好）  
双筒问题：指仅使用一个问题的形式，实际上却有两个独立的问题内容。（不好）可以转为探究式问题  
元问题：那些关于面谈本身的问题  
#### 8.2.3 问题准备

### 8.3 主持面谈
保持面谈主题：对每个主题都在面谈的合适时间安排程序性提示，如在被会见者需要衔接较久的一个主题展开叙述时，使用复述和改述。在被会见者表达一个主题结束时，使用总结和反馈  
使用道具支持：一些简易的模型和草图是可以在面谈中广泛使用的道具  
事实是问题域的特性，问题是需求的来源，所以事实和问题是需求获取的主要获取对象  
面谈记录方式：笔录，录音和摄像  

### 8.4 整理面谈报告
总结面谈信息的主要工作室评估面谈中所得到的信息  
完成面谈报告（具体格式参考课本p208）  

### 8.5 面谈的类别
* 结构化面谈：完全按照事先的问题和结构来控制面谈
* 半结构化面谈：事先需要根据面谈内容准备面谈的问题和面谈结构，但在面谈过程当中，会见者可以根据实际情况采取一些灵活的策略
* 非结构化面谈：没有事先预定的议程安排，甚至会在没有太多事前准备的情况下就直接到访被会见者的工作地，就某个主题开展会谈 

结构化面谈较多使用封闭式问题，所以具有封闭式问题所带来的优缺点；非结构式面谈较多使用开放式问题，所以具有开放式问题所带来的优缺点  
在实际的需求获取中，可以综合考虑结构化面谈和非结构化面谈的折中比较  

### 8.6 面谈的优点和局限性
略

### 8.7 其他需求获取方法
* 群体面谈
* 调查问卷
* 头脑风暴：又译为自由讨论，是一种特殊的群体面谈方法。它的目的不是发现需求，而是“发明”需求，或者说是发现“潜在”需求



